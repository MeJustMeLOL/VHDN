<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Slide — Xác định các yếu tố cốt lõi</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --title-font: 'Playfair Display', serif; --body-font: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; --soft-bg-1: #FFF6F3; --soft-bg-2: #FEF8FF; --brand: #E07A5F; --muted: #667085; --text-main: #25283D; --list-bullet-color: #F2C6B9;
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; width: 100%; margin: 0; padding: 0; background: linear-gradient(180deg, var(--soft-bg-1), var(--soft-bg-2)); font-family: var(--body-font); color: var(--text-main); }
  .slide { position: relative; min-height: 100vh; width: 100vw; display: flex; align-items: center; justify-content: center; overflow: hidden; padding: clamp(30px, 5vw, 60px); }
  .bg-decor { position: absolute; inset: 0; z-index: 0; pointer-events: none; background-image: radial-gradient(circle at 10% 15%, rgba(224,122,95,0.04) 0%, transparent 15%), radial-gradient(circle at 85% 85%, rgba(150,180,170,0.02) 0%, transparent 25%); }

  /* Bố cục bất đối xứng */
  .container { position: relative; z-index: 2; width: 100%; max-width: 1100px; display: grid; grid-template-columns: 6fr 5fr; gap: clamp(2rem, 6vw, 5rem); align-items: center; }
  .text-content { text-align: left; display: flex; gap: 1.25rem; }
  .cross-bar { flex-shrink: 0; width: 5px; height: auto; align-self: stretch; background-color: var(--brand); border-radius: 5px; opacity: 0.6; }
  .image-content img { width: 100%; height: 100%; object-fit: cover; border-radius: 16px; box-shadow: 0 15px 40px rgba(9,30,66,0.12); min-height: 400px; }

  /* Phần nội dung động */
  .dynamic-content-wrapper { width: 100%; position: relative; }
  .view { min-height: 300px; }
  .title { font-family: var(--title-font); font-weight: 800; font-size: clamp(1.8rem, 4vw, 2.4rem); margin: 0 0 1rem 0; line-height: 1.3; }
  ul { list-style-type: none; padding-left: 1.5rem; margin: 0; font-size: clamp(0.95rem, 2vw, 1.05rem); line-height: 1.8; color: var(--muted); }
  ul li { padding-left: 1rem; position: relative; margin-bottom: 0.75rem; }
  ul li::before { content: '•'; position: absolute; left: -1rem; color: var(--list-bullet-color); font-weight: bold; font-size: 1.2rem; }
  ul li strong { color: var(--text-main); font-weight: 500; }

  .sr-only{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}

  @media (max-width: 850px) { .container { grid-template-columns: 1fr; gap: 2.5rem; } .text-content { flex-direction: column; align-items: center; text-align: center; gap: 1rem; } .cross-bar { width: 80px; height: 4px; } .image-content { grid-row: 1; } }
</style>
</head>
<body>
<section class="slide">
  <div class="bg-decor" aria-hidden="true"></div>
  <div class="container">
    <div class="text-content">
      <div class="cross-bar" aria-hidden="true"></div>
      <div class="dynamic-content-wrapper" aria-live="polite">
        <section id="view-0" class="view" data-step="0">
          <h1 class="title">Bắt đầu bằng việc trả lời các câu hỏi</h1>
          <ul>
            <li>Chúng ta đại diện cho điều gì?</li>
            <li>Những hành vi nào đã giúp chúng ta thành công?</li>
            <li>Điều gì là quan trọng nhất, ngay cả khi gặp khó khăn?</li>
            <li>Chúng ta muốn mọi người nói gì về chúng ta?</li>
          </ul>
        </section>
        <section id="view-1" class="view" data-step="1" style="display:none;">
          <h1 class="title">Hai phương pháp xác định giá trị cốt lõi</h1>
          <ul>
            <li><strong>Phương pháp chuyên gia:</strong> Dùng brainstorming và thảo luận giữa các chuyên gia để thống nhất các giá trị.</li>
            <li><strong>Phương pháp điều tra xã hội học:</strong> Dùng bảng hỏi và phỏng vấn để làm rõ các giá trị văn hóa từ các đối tượng liên quan.</li>
          </ul>
        </section>
      </div>
    </div>
    <div class="image-content">
      <img src="https://images.unsplash.com/photo-1542744095-291d1f67b221?q=80&w=2070&auto-format=fit=crop" alt="Nhóm người đang làm việc và thảo luận chiến lược">
    </div>
  </div>
  <p id="notes" class="sr-only">Slide này có 2 phần: Các câu hỏi gợi ý và 2 phương pháp xác định giá trị cốt lõi.</p>
</section>

<script>
(function(){
  let step = 0;
  let isAnimating = false;
  const view0 = document.getElementById('view-0');
  const view1 = document.getElementById('view-1');
  const easing = 'cubic-bezier(0.22, 1, 0.36, 1)'; // Easing mượt, dứt khoát

  // Hàm animation cho các phần tử con, trả về một Promise
  function animateChildren(viewEl, type = 'in') {
    const items = Array.from(viewEl.querySelectorAll('h1, li'));
    const stagger = type === 'in' ? 70 : 35;
    const duration = type === 'in' ? 600 : 300;

    const animations = items.map((item, i) => {
      const keyframes = type === 'in'
        ? [ { opacity: 0, transform: 'translateY(15px)' }, { opacity: 1, transform: 'translateY(0px)' } ]
        : [ { opacity: 1, transform: 'translateY(0px)' }, { opacity: 0, transform: 'translateY(-10px)' } ];

      return item.animate(keyframes, {
        duration: duration,
        delay: i * stagger,
        easing: easing,
        fill: 'forwards'
      }).finished;
    });
    return Promise.all(animations);
  }

  // Hàm chuyển đổi chính
  async function transitionTo(targetStep) {
    if (isAnimating) return; // Chặn animation chồng chéo
    isAnimating = true;

    const currentView = (step === 0) ? view0 : view1;
    const nextView = (targetStep === 0) ? view0 : view1;

    // Nếu không phải chuyển view, chỉ chạy lại animation 'in'
    if (currentView === nextView) {
      await animateChildren(currentView, 'in');
      isAnimating = false;
      return;
    }

    // 1. Chạy animation thoát cho view hiện tại
    await animateChildren(currentView, 'out');

    // 2. Chuyển đổi hiển thị
    currentView.style.display = 'none';
    nextView.style.display = 'block';

    // 3. Chạy animation vào cho view mới
    await animateChildren(nextView, 'in');

    step = targetStep;
    isAnimating = false;
  }

  // Xử lý lệnh từ parent
  window.addEventListener('message', (ev) => {
    const msg = ev.data || {};
    switch(msg.type){
      case 'reset':
        isAnimating = false;
        step = 0;
        view0.style.display = 'block';
        view1.style.display = 'none';
        // Reset tất cả về trạng thái ẩn ban đầu
        [...view0.querySelectorAll('h1, li'), ...view1.querySelectorAll('h1, li')].forEach(el => {
          el.style.opacity = '0';
        });
        break;
      case 'animate-slide':
        transitionTo(step); // Chạy animation cho step hiện tại
        break;
      case 'setStep':
        transitionTo(msg.step === 1 ? 1 : 0);
        break;
      case 'getNotes':
        try { ev.source.postMessage({ type: 'notes', notes: document.getElementById('notes')?.textContent || '' }, '*'); } catch(e){}
        break;
    }
  }, false);

})();
</script>
</body>
</html>
